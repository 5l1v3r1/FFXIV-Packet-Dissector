-- This file is generated by tools/json2lua.js

local db = require('ffxiv_db')
local enum = require('ffxiv_enum')
local ffxiv_ipc_item_info = Proto("ffxiv_ipc_item_info", "FFXIV-IPC ItemInfo")

local item_info_fields = {
  index              = ProtoField.uint32("ffxiv_ipc_item_info.index", "Index", base.DEC),
  unknown0           = ProtoField.uint32("ffxiv_ipc_item_info.unknown0", "Unknown0", base.DEC),
  container_id       = ProtoField.uint16("ffxiv_ipc_item_info.container_id", "ContainerId", base.DEC, enum.reverse.item_location),
  slot               = ProtoField.uint16("ffxiv_ipc_item_info.slot", "Slot", base.DEC),
  quantity           = ProtoField.uint32("ffxiv_ipc_item_info.quantity", "Quantity", base.DEC),
  catalog_id         = ProtoField.uint32("ffxiv_ipc_item_info.catalog_id", "CatalogId", base.DEC, db.Item),
  reserved_flag      = ProtoField.uint32("ffxiv_ipc_item_info.reserved_flag", "ReservedFlag", base.DEC),
  signature_id       = ProtoField.uint64("ffxiv_ipc_item_info.signature_id", "SignatureId", base.DEC),
  quality            = ProtoField.uint8("ffxiv_ipc_item_info.quality", "Quality", base.DEC, enum.reverse.item_quality),
  attribute2         = ProtoField.uint8("ffxiv_ipc_item_info.attribute2", "Attribute2", base.DEC),
  condition          = ProtoField.uint16("ffxiv_ipc_item_info.condition", "Condition", base.DEC),
  spiritbond         = ProtoField.uint16("ffxiv_ipc_item_info.spiritbond", "Spiritbond", base.DEC),
  stain              = ProtoField.uint16("ffxiv_ipc_item_info.stain", "Stain", base.DEC),
  glamour_catalog_id = ProtoField.uint16("ffxiv_ipc_item_info.glamour_catalog_id", "GlamourCatalogId", base.DEC, db.Item),
  unknown6           = ProtoField.uint32("ffxiv_ipc_item_info.unknown6", "Unknown6", base.DEC),
  unknown7           = ProtoField.uint32("ffxiv_ipc_item_info.unknown7", "Unknown7", base.DEC),
  unknown8           = ProtoField.uint32("ffxiv_ipc_item_info.unknown8", "Unknown8", base.DEC),
  unknown9           = ProtoField.uint32("ffxiv_ipc_item_info.unknown9", "Unknown9", base.DEC),
  unknown10          = ProtoField.uint32("ffxiv_ipc_item_info.unknown10", "Unknown10", base.DEC),
  unknown11          = ProtoField.uint32("ffxiv_ipc_item_info.unknown11", "Unknown11", base.DEC),
}

ffxiv_ipc_item_info.fields = item_info_fields

function ffxiv_ipc_item_info.dissector(tvbuf, pktinfo, root)
  local tree = root:add(ffxiv_ipc_item_info, tvbuf)
  pktinfo.cols.info:set("ItemInfo")

  -- dissect the index field
  local index_tvbr = tvbuf:range(0, 4)
  local index_val  = index_tvbr:le_uint()
  tree:add_le(item_info_fields.index, index_tvbr, index_val)

  -- dissect the unknown0 field
  local unknown0_tvbr = tvbuf:range(4, 4)
  local unknown0_val  = unknown0_tvbr:le_uint()
  tree:add_le(item_info_fields.unknown0, unknown0_tvbr, unknown0_val)

  -- dissect the container_id field
  local container_id_tvbr = tvbuf:range(8, 2)
  local container_id_val  = container_id_tvbr:le_uint()
  tree:add_le(item_info_fields.container_id, container_id_tvbr, container_id_val)

  -- dissect the slot field
  local slot_tvbr = tvbuf:range(10, 2)
  local slot_val  = slot_tvbr:le_uint()
  tree:add_le(item_info_fields.slot, slot_tvbr, slot_val)

  -- dissect the quantity field
  local quantity_tvbr = tvbuf:range(12, 4)
  local quantity_val  = quantity_tvbr:le_uint()
  tree:add_le(item_info_fields.quantity, quantity_tvbr, quantity_val)

  local quantity_display = ", Quantity: " .. quantity_val
  pktinfo.cols.info:append(quantity_display)
  tree:append_text(quantity_display)

  -- dissect the catalog_id field
  local catalog_id_tvbr = tvbuf:range(16, 4)
  local catalog_id_val  = catalog_id_tvbr:le_uint()
  tree:add_le(item_info_fields.catalog_id, catalog_id_tvbr, catalog_id_val)

  local catalog_id_display = ", CatalogId: " .. (db.Item[catalog_id_val] or "(unknown)")
  pktinfo.cols.info:append(catalog_id_display)
  tree:append_text(catalog_id_display)

  -- dissect the reserved_flag field
  local reserved_flag_tvbr = tvbuf:range(20, 4)
  local reserved_flag_val  = reserved_flag_tvbr:le_uint()
  tree:add_le(item_info_fields.reserved_flag, reserved_flag_tvbr, reserved_flag_val)

  -- dissect the signature_id field
  local signature_id_tvbr = tvbuf:range(24, 8)
  local signature_id_val  = signature_id_tvbr:le_uint64()
  tree:add_le(item_info_fields.signature_id, signature_id_tvbr, signature_id_val)

  -- dissect the quality field
  local quality_tvbr = tvbuf:range(32, 1)
  local quality_val  = quality_tvbr:le_uint()
  tree:add_le(item_info_fields.quality, quality_tvbr, quality_val)

  local quality_display = ", Quality: " .. (enum.reverse.item_quality[quality_val] or "(unknown)")
  pktinfo.cols.info:append(quality_display)
  tree:append_text(quality_display)

  -- dissect the attribute2 field
  local attribute2_tvbr = tvbuf:range(33, 1)
  local attribute2_val  = attribute2_tvbr:le_uint()
  tree:add_le(item_info_fields.attribute2, attribute2_tvbr, attribute2_val)

  -- dissect the condition field
  local condition_tvbr = tvbuf:range(34, 2)
  local condition_val  = condition_tvbr:le_uint()
  tree:add_le(item_info_fields.condition, condition_tvbr, condition_val)

  -- dissect the spiritbond field
  local spiritbond_tvbr = tvbuf:range(36, 2)
  local spiritbond_val  = spiritbond_tvbr:le_uint()
  tree:add_le(item_info_fields.spiritbond, spiritbond_tvbr, spiritbond_val)

  -- dissect the stain field
  local stain_tvbr = tvbuf:range(38, 2)
  local stain_val  = stain_tvbr:le_uint()
  tree:add_le(item_info_fields.stain, stain_tvbr, stain_val)

  -- dissect the glamour_catalog_id field
  local glamour_catalog_id_tvbr = tvbuf:range(40, 2)
  local glamour_catalog_id_val  = glamour_catalog_id_tvbr:le_uint()
  tree:add_le(item_info_fields.glamour_catalog_id, glamour_catalog_id_tvbr, glamour_catalog_id_val)

  -- dissect the unknown6 field
  local unknown6_tvbr = tvbuf:range(42, 4)
  local unknown6_val  = unknown6_tvbr:le_uint()
  tree:add_le(item_info_fields.unknown6, unknown6_tvbr, unknown6_val)

  -- dissect the unknown7 field
  local unknown7_tvbr = tvbuf:range(44, 4)
  local unknown7_val  = unknown7_tvbr:le_uint()
  tree:add_le(item_info_fields.unknown7, unknown7_tvbr, unknown7_val)

  -- dissect the unknown8 field
  local unknown8_tvbr = tvbuf:range(48, 4)
  local unknown8_val  = unknown8_tvbr:le_uint()
  tree:add_le(item_info_fields.unknown8, unknown8_tvbr, unknown8_val)

  -- dissect the unknown9 field
  local unknown9_tvbr = tvbuf:range(52, 4)
  local unknown9_val  = unknown9_tvbr:le_uint()
  tree:add_le(item_info_fields.unknown9, unknown9_tvbr, unknown9_val)

  -- dissect the unknown10 field
  local unknown10_tvbr = tvbuf:range(56, 4)
  local unknown10_val  = unknown10_tvbr:le_uint()
  tree:add_le(item_info_fields.unknown10, unknown10_tvbr, unknown10_val)

  -- dissect the unknown11 field
  local unknown11_tvbr = tvbuf:range(60, 4)
  local unknown11_val  = unknown11_tvbr:le_uint()
  tree:add_le(item_info_fields.unknown11, unknown11_tvbr, unknown11_val)

  return tvbuf:len()
end